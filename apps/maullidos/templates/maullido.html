<div class="maullido-card" id="maullido-{{ post.id }}">
    <a href="{% url 'userProfile' username=post.postUser.username %}">
        {{ post.postUser.username }}
    </a>
    <p>{{ post.body }}</p>

    <div class="maullido-actions">
        <button onclick="reactMaullido({{ post.id }}, 'happy')">ðŸ˜º</button>
        <span id="happys-{{ post.id }}">{{ post.happys_count }}</span>

        <button onclick="reactMaullido({{ post.id }}, 'sad')">ðŸ˜¿</button>
        <span id="sads-{{ post.id }}">{{ post.sads_count }}</span>

        <button onclick="reactMaullido({{ post.id }}, 'love')">ðŸ˜»</button>
        <span id="loves-{{ post.id }}">{{ post.loves_count }}</span>

        <button onclick="reactMaullido({{ post.id }}, 'shocked')">ðŸ™€</button>
        <span id="shockeds-{{ post.id }}">{{ post.shockeds_count }}</span>
        
        <button onclick="reactMaullido({{ post.id }}, 'angry')">ðŸ˜¾</button>
        <span id="angrys-{{ post.id }}">{{ post.angrys_count }}</span>
    </div>

    <p><small>{{ post.postDate|date:"d/m/Y" }}</small></p>
</div>
<script>
    function reactMaullido(maullidoId, action) {
        const url = `{% url 'reactMaullido' 0 %}`.replace('0', maullidoId);
        fetch(url, {
            method: "POST",
            headers: {
                "X-CSRFToken": getCookie("csrftoken"),
                "Content-Type": "application/x-www-form-urlencoded",
            },
            body: `action=${action}`,
        })
            .then(response => response.json())
            .then(data => {
                document.getElementById(`happys-${maullidoId}`).textContent = data.happys;
                document.getElementById(`sads-${maullidoId}`).textContent = data.sads;
                document.getElementById(`loves-${maullidoId}`).textContent = data.loves;
                document.getElementById(`shockeds-${maullidoId}`).textContent = data.shockeds;
                document.getElementById(`angrys-${maullidoId}`).textContent = data.angrys;
            });
    }

    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let cookie of cookies) {
                cookie = cookie.trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>